(()=>{"use strict";class t{#t;#e;#s;constructor(t,e){this.#t=0,this.#e=t,this.#s=e}next=()=>{if(this.#t){const{done:t,value:e}=this.#s.next();if(t)return{done:t,value:e};{const{key:t,parameter:s}=e;return{done:!1,value:`${t}:${s}`}}}return this.#t=1,{done:!1,value:this.#e}}}const e=Object.freeze((()=>{const t=new Map;return function(t){const e=new Map;t.set("calendar_grid",e),e.set(0,"<table> "),e.set(1," <tbody> "),e.set(2," <tr> "),e.set(3," <td "),e.set(4," >"),e.set(5,"</td> "),e.set(6," </tr> "),e.set(7," </tbody> "),e.set(8," </table>")}(t),function(t){const e=new Map;t.set("calendar_grid_rows",e),e.set(0,"<table> <thead> <tr> <th><abbr>Lun.</abbr></th> <th><abbr>Mar.</abbr></th> <th><abbr>Mer.</abbr></th> <th><abbr>Jeu.</abbr></th> <th><abbr>Ven.</abbr></th> <th><abbr>Sam.</abbr></th> <th><abbr>Dim.</abbr></th> </tr> </thead> "),e.set(1,' <tbody> <tr class="bar"> <th colspan="7" ><app-french-month strmonth="'),e.set(2,'"></app-french-month> </th> </tr> '),e.set(3," <tr> "),e.set(4," <td "),e.set(5," >"),e.set(6,"</td> "),e.set(7," </tr> "),e.set(8," </tbody> "),e.set(9," </table>")}(t),t})());class s{#r;#n;#a;constructor(){this.#r=new Map,this.#n=[],this.#a=""}#i(){this.#a+=this.#n.join(""),this.#n=[]}accept=t=>{console.log(t);const s=function(t){if(t)if(t.startsWith("E_SL:")){const s=(t=t.substring(5)).substring(0,t.indexOf(":")),r=parseInt(t.substring(s.length+1)),n=e.get(s)?.get(r);if(null!=n)return n;console.warn(`Unresolved slice ${r} for template ${s}`)}else{if(t.startsWith("E_ID:"))return` data-uuid="${t=t.substring(5)}" `;if(t.startsWith("E_ATTR:")){t=t.substring(7);const[e,s,r]=t.split(":");if(e&&s)return{elementUuid:e,effect:t=>r?t.setAttribute(s,r):t.removeAttribute(s)}}else{if(!t.startsWith("E_CLS:"))return t;{t=t.substring(6);const[e,s]=t.split(":");if(e&&s)return{elementUuid:e,effect:t=>t.classList.add(s)}}}}}(t);if(null!=s)if("string"==typeof s)this.#n.push(s),this.#n.length>16&&this.#i();else{const{elementUuid:t,effect:e}=s;this.#r.has(t)||this.#r.set(t,[]),this.#r.get(t).push(e)}};get output(){return this.#i(),{template:this.#a,effectPlayer:t=>{for(const e of this.#r.keys()){const s=t.querySelector(`*[data-uuid=${e}]`);for(const t of this.#r.get(e))t(s)}}}}}class r{#o;#c;constructor(e,r){{const{preamble:s,queryParametersIterator:r}=e;this.#o=new t(s,r)}this.#c=new s}read=()=>{const{done:t,value:e}=this.#o.next();return t?null:e};write=t=>{this.#c.accept(t)};get output(){return this.#c.output}rebindInputStream(t){this.#o=t}}class n{#u;constructor(t){this.#u=t}get size(){return this.#u.length}get(t){return this.#u[t]}set(t,e){t<this.size&&0<=t&&(this.#u[t]=e)}push(t){this.#u.push(t)}}class a{#_;constructor(){this.#_=new Map}getSeries(t){return this.#_.get(t)}createEmptySeries(){let t=0;do{t+=1}while(this.#_.has(t));return this.#_.set(t,new n([])),t}disposeSeries(t){this.#_.delete(t)}}function i(t,e){window.__APP_DYNAMIC_MEMORY__=new a;const s=new r({preamble:t,queryParametersIterator:e});return window.__APP_WASM_SOCKET__=s,this.accept(),s.output}window.__APP_WASM_SOCKET__=null,window.__APP_DYNAMIC_MEMORY__=null,window.addEventListener("load",(async function(){let t;console.log("Main JS is loaded");{let o=null;const c=new TextEncoder,u=new TextDecoder;function _(t){let e=0;for(const s of t)if(e+=1,!s)break;const s=t.subarray(0,e-1);return u.decode(s)}const l={app_throw_error:function(t){const e=_(o.subarray(t));throw new WebAssembly.RuntimeError(e)},app_read_from_socket:function(t,e){try{const s=window.__APP_WASM_SOCKET__.read();if(null!=s){const r=c.encode(s),n=r.byteLength+1;if(e>n)return o.subarray(t,t+e).set(r),o[t+r.byteLength]=0,n}}catch(t){console.error(t)}return 0},app_write_to_socket:function(t){try{const e=window.__APP_WASM_SOCKET__,s=_(o.subarray(t));if(null!=s)return e.write(s),1}catch(t){}return 0},app_series_create:function(){try{return window.__APP_DYNAMIC_MEMORY__.createEmptySeries()}catch(t){console.error(t)}return 0},app_series_dispose:function(t){try{window.__APP_DYNAMIC_MEMORY__.disposeSeries(t)}catch(t){}},app_series_get_as_int:function(t,e){try{return window.__APP_DYNAMIC_MEMORY__.getSeries(t).get(e)}catch(t){}return 0},app_series_set_int:function(t,e,s){try{window.__APP_DYNAMIC_MEMORY__.getSeries(t).set(e,s)}catch(t){}},app_series_push_int:function(t,e){try{window.__APP_DYNAMIC_MEMORY__.getSeries(t).push(e)}catch(t){}},app_series_size:function(t){try{return window.__APP_DYNAMIC_MEMORY__.getSeries(t).size}catch(t){}return-1}};let h=await fetch("next-app-module.wasm");console.log(h),l.memory=new WebAssembly.Memory({initial:2}),o=new Uint8Array(l.memory.buffer);const p=await WebAssembly.instantiateStreaming(h,{env:l});console.log(p),t=p.instance.exports}const e={accept:function(){return t.accept(t.__heap_base,1024)},syncFetch:i},s=Date.now(),{template:r,effectPlayer:n}=e.syncFetch("GET calendar",function*(){yield{key:"today_date",parameter:"2023-09-07"},yield{key:"weeks_count",parameter:"3"},yield{key:"focus_date",parameter:"2023-09-20"}}());document.write("**",r),n(document.body);const a=Date.now();console.log("JS perspective, took",a-s)}))})();